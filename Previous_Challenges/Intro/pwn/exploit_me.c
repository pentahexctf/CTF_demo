/*
Target of this program is to over flow stack in such a way that return address
from foo function is changed to bar.
Compilation command:
gcc -m32 -g -fno-stack-protector exploit_me_1.c -o exploit_me_1
Arguments used:
	-m32: instrcuting the compiler to build 32 bit Binary
	-g: This allow C code to visible in gdb
	-fno-stack-protector: Disbale stack protection by canary
*/

#include <stdio.h>

//0 is not authenticated
//1 is user authetication
//2 is admin authentication

int auth_level = 0;

void admin_login()
{
    printf("You are now an admin\n");
	auth_level = 2;
}

void user_login()
{
	printf("You are now a user\n");
	auth_level = 1;
}

void login()
{
	puts("Welcome to the user login page!!");
	puts("Enter your user name");
    char username[10];
    scanf("%s", username);
    printf("Hello new user, prepare to authenticate %s \n", username);
	int auth;
	puts("What is the admin password?");
	scanf("%d", &auth);
	if(auth == 1337)
		admin_login();
	else
		user_login();
	
}

int main()
{
    login();
    return 0;
}